const { cmd } = require('../command');
const fetch = require('node-fetch');

cmd({
    pattern: "gdrive",
    alias: ["gdrivefile"],
    react: "ğŸ“‚",
    desc: "ğŸ“¥ ğ——ğ—¼ğ˜„ğ—»ğ—¹ğ—¼ğ—®ğ—± ğ—³ğ—¶ğ—¹ğ—²ğ˜€ ğ—³ğ—¿ğ—¼ğ—º ğ—šğ—¼ğ—¼ğ—´ğ—¹ğ—² ğ——ğ—¿ğ—¶ğ˜ƒğ—²",
    category: "ğŸ“ ğ——ğ—¼ğ˜„ğ—»ğ—¹ğ—¼ğ—®ğ—±",
    filename: __filename
},
async (conn, mek, m, { from, quoted, args, q, reply }) => {
    try {
        if (!q) return reply("ğŸŒ€âŒ *ã€ ğ—£ğ—¹ğ—²ğ—®ğ˜€ğ—² ğ—½ğ—¿ğ—¼ğ˜ƒğ—¶ğ—±ğ—² ğ—® ğ—šğ—¼ğ—¼ğ—´ğ—¹ğ—² ğ——ğ—¿ğ—¶ğ˜ƒğ—² ğ—¹ğ—¶ğ—»ğ—¸! ã€* âŒğŸŒ€");

        const apiUrl = `https://api.davidcyriltech.my.id/gdrive?url=${encodeURIComponent(q)}`;
        const res = await fetch(apiUrl);
        const data = await res.json();

        if (!data || !data.success || !data.download_link) {
            return reply("ğŸ”®ğŸš« *ã€ ğ—˜ğ—¿ğ—¿ğ—¼ğ—¿ ğ—³ğ—²ğ˜ğ—°ğ—µğ—¶ğ—»ğ—´ ğ—³ğ—¶ğ—¹ğ—². ğ—œğ—»ğ˜ƒğ—®ğ—¹ğ—¶ğ—± ğ—¹ğ—¶ğ—»ğ—¸ ğ—¼ğ—¿ ğ—®ğ—°ğ—°ğ—²ğ˜€ğ˜€ ğ—±ğ—²ğ—»ğ—¶ğ—²ğ—±! ã€* ğŸš«ğŸ”®");
        }

        let desc = `
âœ¦â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢âœ¦
   âœ§ğ—šğ—¢ğ—¢ğ—šğ—Ÿğ—˜ ğ——ğ—¥ğ—œğ—©ğ—˜ ğ——ğ—¢ğ—ªğ—¡ğ—Ÿğ—¢ğ—”ğ——ğ—˜ğ—¥âœ§
âœ¦â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢â™¢âœ¦

âˆâ¤ ğ—™ğ—œğ—Ÿğ—˜ ğ—¡ğ—”ğ— ğ—˜ âŸ ã€ ğ—•ğ—¼ğ—¹ğ—± ${data.name} ã€
âˆâ¤ ğ—¦ğ—§ğ—”ğ—§ğ—¨ğ—¦ âŸ ğŸ“¤ ğ——ğ—¼ğ˜„ğ—»ğ—¹ğ—¼ğ—®ğ—±ğ—¶ğ—»ğ—´...

âœ¦âœ§âœ¦âœ§âœ¦âœ§âœ¦âœ§âœ¦âœ§âœ¦âœ§âœ¦âœ§âœ¦âœ§âœ¦âœ§âœ¦âœ§âœ¦âœ§âœ¦

â–£ ğ—£ğ—¼ğ˜„ğ—²ğ—¿ğ—²ğ—± ğ—¯ğ˜† âŸ ğ—›ğ—®ğ—»ğ˜€ ğ—•ğ˜†ğ˜ğ—² ğ— ğ—— à¼—
â–£ ğ—¦ğ—²ğ—¿ğ˜ƒğ—²ğ—¿ âŸ ğ—–ğ—¹ğ—¼ğ˜‚ğ—±-ğ—–ğ—±ğ—» à¼—
`;

        await conn.sendMessage(from, { text: desc }, { quoted: mek });

        await conn.sendMessage(from, { 
            document: { url: data.download_link }, 
            mimetype: "application/octet-stream", 
            fileName: `ã€ âœ¦ ${data.name} âœ¦ ã€`, 
            caption: `
â™š ğ——ğ—¢ğ—ªğ—¡ğ—Ÿğ—¢ğ—”ğ—— ğ—–ğ—¢ğ— ğ—£ğ—Ÿğ—˜ğ—§ğ—˜ğ—— â™š

âœ§ ğ—™ğ—¶ğ—¹ğ—² âŸ ${data.name}
âœ§ ğ—¦ğ—¶ğ˜‡ğ—² âŸ ${data.size || 'N/A'}
âœ§ ğ—¤ğ˜‚ğ—®ğ—¹ğ—¶ğ˜ğ˜† âŸ ğ—Ÿğ—¼ğ˜€ğ˜€ğ—¹ğ—²ğ˜€ğ˜€

â–£ ğ—£ğ—¼ğ˜„ğ—²ğ—¿ğ—²ğ—± ğ—¯ğ˜† âŸ ğ—›ğ—®ğ—»ğ˜€ ğ—•ğ˜†ğ˜ğ—² ğ— ğ—— à¼—
â–£ ğ—¦ğ˜‚ğ—½ğ—½ğ—¼ğ—¿ğ˜ âŸ ğ—–ğ—¹ğ—¼ğ˜‚ğ—±-ğ—–ğ—±ğ—» à¼—
` 
        }, { quoted: mek });

    } catch (e) {
        console.error(e);
        reply("ğŸŒ€âš ï¸ *ã€ ğ—˜ğ—¿ğ—¿ğ—¼ğ—¿ ğ—½ğ—¿ğ—¼ğ—°ğ—²ğ˜€ğ˜€ğ—¶ğ—»ğ—´ ğ—¿ğ—²ğ—¾ğ˜‚ğ—²ğ˜€ğ˜! ğ—£ğ—¹ğ—²ğ—®ğ˜€ğ—² ğ˜ğ—¿ğ˜† ğ—®ğ—´ğ—®ğ—¶ğ—» ğ—¹ğ—®ğ˜ğ—²ğ—¿ ã€* âš ï¸ğŸŒ€");
    }
});